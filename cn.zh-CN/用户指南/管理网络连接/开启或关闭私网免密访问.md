# 开启或关闭私网免密访问

云数据库MongoDB支持在专有网络环境下开启免密访问，在保障高安全性的前提下提供更便捷的数据库连接方式。开启私网免密访问后，与MongoDB实例位于同一个VPC的ECS实例可以免密码连接MongoDB数据库，同时仍然支持通过用户名和密码的方式连接MongoDB数据库。

## 前提条件

-   数据库版本为4.0（数据库小版本为mongodb\_20190408\_3.0.11或以上版本）、4.2版本的副本集实例和分片集群实例；数据库版本为4.4版本的副本集实例。如果版本过低请升级，详情请参见[升级数据库版本](/cn.zh-CN/用户指南/实例管理/数据库升级/升级数据库版本.md)和[升级数据库小版本](/cn.zh-CN/用户指南/实例管理/数据库升级/升级数据库小版本.md)。

    **说明：** 您可以通过实例的**基本信息**页面查看实例的数据库版本和数据库小版本。

-   实例的网络类型为专有网络。如果网络类型为经典网络，您可以[从经典网络切换为专有网络](/cn.zh-CN/用户指南/管理网络连接/切换实例网络类型.md)。

## 开启或关闭私网免密访问

1.  登录[MongoDB管理控制台](https://mongodb.console.aliyun.com/)。

2.  在页面左上角，选择实例所在的资源组和地域。

3.  根据实例类型，在左侧导航栏单击**副本集实例列表**或**分片集群实例列表**。

4.  找到目标实例，单击实例ID。

5.  在左侧导航栏，单击**数据库连接**。

6.  在**私网连接 - 专有网络**区域框的右上角，单击**开启私网免密访问**或**关闭私网免密访问**。

    -   开启私网免密访问。

        **说明：**

        -   如需通过私网免密访问MongoDB数据库，您还需要将客户端的IP地址加入MongoDB实例的白名单中，详情请参见[设置白名单及安全组](/cn.zh-CN/用户指南/数据安全性/设置白名单及安全组.md)。
        -   MongoDB 4.4版本副本集实例在开启私网免密访问后将不能够对其进行关闭，请谨慎操作。
        开启私网免密访问后，与MongoDB实例位于同一个VPC的[ECS](~~25367~~)实例可以免密码连接MongoDB数据库，同时仍然支持通过用户名和密码的方式连接MongoDB数据库。

        ![开启私网免密访问](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/8487427161/p45177.png)

        Mongo Shell免密连接示例：

        ```
        mongo --host dds-bpxxxxxxxx.mongodb.rds.aliyuncs.com:3717
        ```

    -   关闭私网免密访问。

        **说明：**

        -   MongoDB 4.4版本副本集实例不支持关闭私网免密访问。
        -   关闭私网免密访问功能后会导致使用免密访问功能的应用程序无法连接数据库，请在关闭私网免密访问功能之前调整应用程序连接数据库的方式。
        ![关闭私网免密访问](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/8487427161/p45178.png)

7.  在弹出的对话框中，单击**确定**。


## 相关API

|API名称|描述|
|-----|--|
|[ModifyInstanceVpcAuthMode](/cn.zh-CN/API参考/连接管理/ModifyInstanceVpcAuthMode.md)|开启或关闭私网免密访问功能。|

