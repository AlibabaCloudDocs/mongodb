# 创建多可用区分片集群实例

为进一步满足业务场景中高可靠性的需求，云数据库MongoDB为分片集群实例提供了同城容灾解决方案。该方案将分片集群实例中的组件分别部署在同一地域下三个不同的可用区，通过内部网络实现节点间的信息互通。当三个可用区中的任一可用区因电力、网络等不可抗因素失去通信时，高可用系统将自动触发切换操作，确保整个分片集群架构的持续可用。

## 注意事项

目前仅部分地域支持创建多可用区分片集群实例，具体的支持情况请以控制台为准。

![多可用区](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/1029271161/p232861.png)

**说明：** 在创建实例页面，您可以在选择目标**地域**之后单击**可用区**，在下拉菜单中即可查看该地域的多可用区支持情况。包含多个字母的可用区即多可用区，如上图所示。

## 节点部署策略

选择单可用区时，系统会将分片集群实例的组件部署在同一可用区；选择多可用区时，系统会将分片集群实例的组件分别部署在三个不同的可用区中。

-   Mongos节点的部署遵循所有机房均衡的原则。Mongos节点最少为两个，分别部署在两个可用区中，当增加第三个时，默认部署在第三个可用区，后续增加的Mongos节点依次部署在各可用区内。
-   每个Shard节点中的Primary节点、Secondary节点与Hidden节点并非顺序部署在三个可用区中，可能会随着手动切换主备或触发高可用系统而改变。

![](../images/p46749.png "多可用区分片集群实例各组件节点的部署策略")

## 操作步骤

1.  登录[MongoDB管理控制台](https://mongodb.console.aliyun.com/)。

2.  在左侧导航栏，单击**分片集群实例列表**。

3.  在**分片集群实例列表**页面，单击**创建实例**。

4.  选择**分片集群（包年包月）**或**分片集群（按量付费）**。

    **说明：**

    -   包年包月：在新建实例时支付费用。适合长期需求，价格比按量付费更实惠，且购买时长越长，折扣越多。
    -   按量付费：后付费，按小时扣费。适合短期需求，用完可立即释放实例，节省费用。
5.  选择支持多可用区的**地域**，并选择相应的多可用区。

6.  设置实例的其他配置项目，详情请参见[创建分片集群实例](/cn.zh-CN/快速入门/创建实例/创建分片集群实例.md)。

7.  单击**立即购买**，进入确认订单页面。

8.  阅读并选中服务条款，根据提示完成支付流程。


## 更多信息

您可以通过服务可用性功能，直观地了解实例中的节点在可用区中的分布情况，您还可以根据业务的部署情况切换节点的角色，满足应用就近连接的需求，详情请参见[切换节点角色](/cn.zh-CN/用户指南/实例管理/切换节点角色.md)。

