# MongoDB单库恢复 {#concept_kvp_mrg_fhb .concept}

云数据库MongoDB支持单库恢复功能，您可以选择实例运行的某个时间点新建实例，将单个或多个数据库恢复到该时间点，适用于单个或多个数据库快速数据恢复的业务场景。

## 上线说明 {#section_orh_qqh_fhb .section}

自2019年3月26日后新建的实例支持单库恢复，现存的实例将在后续统一开启该功能，具体时间请关注官网公告。

## 前提条件 {#section_zgq_r3b_fhb .section}

-   实例的创建时间晚于2019年3月26日。
-   实例属于华北 1、华北 2、华北 3、华北 5、华东 1、华东 2、华南 1或亚太东南 1（新加坡）地域，其他地域暂不支持。
-   实例类型须为副本集实例，暂不支持单节点实例和分片集群实例。
-   实例版本须为3.4版本或4.0版本，暂不支持3.2版本。
-   实例存储引擎须为WiredTiger，暂不支持RocksDB和TerarkDB。
-   实例备份列表中的备份文件须包含需要恢复的数据库。

## 注意事项 {#section_y5t_vsg_fhb .section}

-   仅支持基于物理备份的单库恢复，暂不支持基于逻辑备份的单库恢复。
-   仅支持在新实例中进行数据恢复，暂不支持将数据直接恢复至当前实例。

    **说明：** 使用单库恢复功能将创建一个新的实例，创建的实例会产生相关费用，详情请参考[收费项目及价格说明](https://help.aliyun.com/document_detail/54285.html#concept-jww-bny-32b)。

-   新实例执行单库恢复所需的时间和数据量、任务队列、网络等多种因素有关，您只需要等待新实例的运行状态变更为**运行中**即可。

## 操作步骤 {#section_ghm_m5b_fhb .section}

1.  登录[MongoDB管理控制台](https://mongodb.console.aliyun.com/)。
2.  在页面左上角，选择实例所在的地域。
3.  在左侧导航栏，单击**副本集实例列表**。
4.  找到目标实例，单击实例ID。
5.  在左侧导航栏，单击**备份与恢复**。
6.  在备份与恢复页面，单击**按时间点新建实例**。
7.  在弹出的对话框中设置以下参数。

    ![MongoDB单库恢复](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/149680/156462533941591_zh-CN.png)

    |配置项目|配置说明|
    |:---|:---|
    |选择要恢复的时间点|选择实例运行的某个时间点进行数据恢复，可以选择7天内的任意时间点进行恢复。 **说明：** 恢复的时间点须早于当前时间，晚于实例创建时间。

 |
    |选择要恢复的数据库|     -   全部数据库：恢复实例的全部数据库。
    -   部分数据库：恢复实例的部分数据库，您可以直接勾选需恢复的数据库，也可以单击**切换为手动输入数据库**，手动输入需要恢复的数据库。

**说明：** 在手动输入数据库的模式下，如需恢复多个数据库，多个数据库之间用逗号（,）隔开。

 |

8.  单击**确定**，页面将跳转至实例购买页面。
9.  选择新购实例的配置信息。

    **说明：** 在实例的**基本配置**区域，不可变更实例的**地域**、**数据库版本**、**存储引擎**和**节点数**信息。

    |参数配置区|参数项|说明|
    |:----|:--|:-|
    |**基本配置**|**可用区**| 可用区是指在同一地域内，电力和网络互相独立的物理区域，详情请参见[地域和可用区](https://help.aliyun.com/document_detail/40654.html)。

 在同一地域内、不同可用区之间的MongoDB实例和ECS实例可以通过内网进行连接，详情请参见[MongoDB跨可用区内网访问实例](cn.zh-CN/用户指南/连接实例/MongoDB跨可用区内网访问实例.md#)。

 **说明：** 同一可用区内ECS实例和MongoDB实例通过内网连接时，网络延时最小。

 |
    |**网络类型**|-|     -   **经典网络**：经典网络中的云服务在网络上不进行隔离，只能依靠云服务自身的安全组或白名单策略来阻挡非法访问。
    -   **专有网络**（推荐）：也称为VPC（Virtual Private Cloud）。VPC是一种隔离的网络环境，安全性和性能均高于传统的经典网络，专有网络需要事先创建，详情请参见[新建实例场景下配置专有网络](cn.zh-CN/用户指南/管理网络连接/新建实例场景下配置专有网络.md#)。
 |
    |**规格配置**|**规格**|     -   实例占用的CPU和内存。
    -   不同规格对应不同的最大连接数和IOPS（即读和写分别可以达到的最大值，混合读写最高可以达到指标的2倍）。
 |
    |**存储空间**|副本集实例中每个节点独享的存储空间。 **说明：** 节点的存储空间包含您的数据文件、系统文件、日志文件空间。

 |
    |**密码设置**|     -   **立即设置**
    -   **创建后设置**
 |设置初次连接MongoDB数据库的账户密码，您可以在创建实例时设置密码，也可以在实例运行期间[设置密码](cn.zh-CN/副本集快速入门/设置密码.md#)。     -   密码由大写、小写、数字、特殊字符中的任意三种组成，特殊字符为!\#$%^&\*\(\)\_+-=
    -   密码长度为8-32位。
 |
    |**购买量**|**购买时长**|包年包月：选择包年包月实例的时长和数量，包月可选择1~9个月，包年可选择1~3年。 **说明：** 仅包年包月实例需要设置该参数。

 |
    |**数量**|择相同配置的实例的数量，可以设置为1~10的整数。|

10. 单击**立即购买**，进入订单确认页面。
11. 在确认订单页面，阅读并勾选**云数据库MongoDB版服务协议**，根据提示完成支付流程。

