# 创建分片集群实例 {#task_g3q_hyq_w2b .task}

您可以通过控制台或者[API](../intl.zh-CN/API参考/生命周期管理/CreateShardingDBInstance.md#)创建MongoDB分片集群实例。本文将介绍如何在MongoDB控制台上创建分片集群实例。

-   已注册阿里云账号，注册流程请参见[注册阿里云账号](https://www.alibabacloud.com/help/zh/doc-detail/50482.htm)。
-   若您要创建按量付费的实例，请确保您的账户余额大于等于100元。

## 费用说明 {#section_lfr_35y_9m0 .section}

详情请参见[收费项目及价格说明](../intl.zh-CN/产品定价/收费项目及价格说明.md#)。

## 操作步骤 {#section_jx6_u75_ikf .section}

1.  登录[MongoDB管理控制台](https://mongodb.console.aliyun.com/#/mongodb/list)。
2.  在左侧导航栏，单击**分片集群实例列表**。
3.  在**分片集群实例列表**页面，单击**新建实例**。
4.  选择**分片集群（包年包月）**或**分片集群（按量付费）**。 

    **说明：** 

    -   包年包月：在新建实例时支付费用。适合长期需求，价格比按量付费更实惠，且购买时长越长，折扣越多。
    -   按量付费：后付费，按小时扣费。适合短期需求，用完可立即释放实例，节省费用。
5.  选择实例配置，参数说明如下表所示。 

    |类别|配置|说明|
    |:-|:-|:-|
    |**基本配置**|**地域**| 实例所属地理位置，实例创建成功后无法更换地域，请谨慎选择。

 在同一地域内的实例（如[ECS](https://www.alibabacloud.com/help/zh/doc-detail/25367.htm)与MongoDB之间）可以通过内网进行连接。

 |
    |**可用区**| [可用区](https://www.alibabacloud.com/help/zh/doc-detail/40654.htm#h2-url-2)是指在同一地域内，电力和网络互相独立的物理区域。同一可用区内ECS实例和MongoDB实例通过内网连接时，网络延时最小。

**说明：** 您可以选择多可用区实现实例的同城容灾，详情请参考[创建多可用区分片集群实例](../intl.zh-CN/用户指南/同城容灾解决方案/创建多可用区分片集群实例.md#)。

 在同一地域内、不同可用区之间的MongoDB实例和ECS实例可以通过内网进行连接，详情请参见[MongoDB跨可用区内网访问实例](../intl.zh-CN/用户指南/连接实例/MongoDB跨可用区内网访问实例.md#)。

 同一可用区内ECS实例和MongoDB实例通过内网连接时，网络延时最小。

 |
    |**数据库版本**| MongoDB分片集群实例支持3.2、3.4、4.0数据库版本。

 建议您选择MongoDB 3.2以上版本，3.4版本在性能和安全性等方面较3.2版本均有不同程度的提升，详情请参见[版本与存储引擎](../intl.zh-CN/产品简介/版本及存储引擎.md#)。

 **说明：** 支持在实例运行期间手动升级数据库版本至3.4版本或4.0版本。版本升级后不支持降级。详情请参见[升级数据库版本](../intl.zh-CN/用户指南/实例管理/升级数据库版本.md#)。

 |
    |**存储引擎**| MongoDB分片集群实例支持WiredTiger。

 关于版本与存储引擎的对应关系请参考[版本与存储引擎](../intl.zh-CN/产品简介/版本及存储引擎.md#)。

 |
    |**网络类型**|**经典网络**|经典网络：经典网络中的云服务在网络上不进行隔离，只能依靠云服务自身的安全组或白名单策略来阻挡非法访问。|
    |**专有网络**|专有网络（推荐）：也称为VPC（Virtual Private Cloud）。VPC是一种隔离的网络环境，安全性和性能均高于传统的经典网络，专有网络需要事先创建，具体设置请参见[新建实例场景下配置专有网络](../intl.zh-CN/用户指南/管理网络连接/新建实例场景下配置专有网络.md#)。 **说明：** 

    -   您也可以在创建实例后再更改网络类型，具体请参见[切换实例网络类型](../intl.zh-CN/用户指南/管理网络连接/切换实例网络类型.md#)。
    -   此外，您还可以通过专线或者VPN的方式将自建机房与阿里云专有网络内的云资源组合成一个虚拟机房，实现应用平滑上云。具体方案请参考：[经典网络平滑迁移到VPC的混访方案](../intl.zh-CN/用户指南/管理网络连接/经典网络平滑迁移到VPC的混访方案.md#)。
 |
    |**mongos规格配置**|**mongos规格**| 分片集群实例中mongos节点的规格。关于mongos节点的规格详情，请参见[实例规格](../intl.zh-CN/产品简介/实例规格表.md#)。

 支持在实例运行期间增加mongos节点，以及对mongos节点进行升降级配置。

 变更实例配置将产生费用变化，详情请参见[收费方式及价格说明](../intl.zh-CN/产品定价/收费项目及价格说明.md#)。

 |
    |**数量**| mongos节点的数量。

 一个分片集群实例中mongos节点数量为2~32个。

 |
    |**shard规格配置**|**shard规格配置**| 分片集群实例中shard节点的规格。关于shard节点的规格详情，请参见[实例规格](../intl.zh-CN/产品简介/实例规格表.md#)。

 支持在实例运行期间增加shard节点，以及对shard节点进行升降级配置。

 变更实例配置将产生费用变化，详情请参见[收费方式及价格说明](../intl.zh-CN/产品定价/收费项目及价格说明.md#)。

 |
    |**存储空间**| 分片集群实例中每个shard节点的存储空间。shard节点的存储空间大小为10~1000GB。

 shard节点的存储空间包含您的数据文件、系统文件、日志文件空间。

 |
    |**数量**| shard节点的数量。

 一个分片集群实例中shard节点数量为2~32个。

 |
    |**ConfigServer规格配置**|**ConfigServer规格**| configserver的规格配置固定为1核2GB，存储空间固定为20GB，且上述参数均不支持修改。

 |
    |**密码设置**|-| 设置初次连接MongoDB数据库的账户密码。

     -   密码由大写、小写、数字、特殊字符中的任意三种组成，特殊字符为!\#$%^&\*\(\)\_+-=
    -   密码长度为8-32位
 可以在创建实例时设置密码，也可以在实例运行期间设置或重置密码。

 |

6.  完成上述参数配置后，单击**立即购买**。
7.  在确认订单页面，勾选云数据库MongoDB版服务协议，根据提示完成支付流程。

## 查看已创建的实例 {#section_w0s_59q_9fp .section}

1.  登录[MongoDB管理控制台](https://mongodb.console.aliyun.com/)。
2.  在页面左上角，选择实例所在的地域。 

    ![选择地域](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/6659/156629281556669_zh-CN.png)

3.  在左侧导航栏，单击**分片集群实例列表**。

## 无法找到实例 {#section_dtb_ebw_yko .section}

|可能原因|解决方法|
|----|----|
|选择了错误的地域|参照[查看已创建的实例](#section_w0s_59q_9fp)操作，重新选择正确的地域。|
|选择了错误的实例列表|参照[查看已创建的实例](#section_w0s_59q_9fp)操作，选择**分片集群实例列表**。|
|未刷新/过早刷新控制台|您可以等待一段时间（通常为几分钟）后刷新控制台，再查看副本集实例列表中是否会出现实例。|
|资源不足| 新创建的实例可能因为资源不足而退款，您可以在[订单管理](https://expense.console.aliyun.com/#/order/list/)中查看到退款。

 在您确认退款后，您可以更换可用区尝试再次购买，您也可以或者提交工单处理。

 |

在[MongoDB管理控制台](https://mongodb.console.aliyun.com/#/mongodb/list)的左上角，选择实例所在的地域，即可查看到创建的实例。

创建实例后，您还需要[设置白名单](intl.zh-CN/分片集群快速入门/设置白名单.md#)，如果您需要通过公网连接实例，您还需要[申请公网连接地址](intl.zh-CN/分片集群快速入门/申请公网连接地址.md#)。

关于连接实例的方法和场景，请参见[连接实例](../intl.zh-CN/用户指南/连接实例/连接实例.md#)。

